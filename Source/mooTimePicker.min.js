/*
---
description:     
  - mooTimePicker is a sliding timepicker. Allows to select seconds, and the amount of hours/minutes/seconds each step change.

authors:
  - Marcelo Origoni

version:
  - 1.0

license:
  - MIT-style license

requires:
  - core/1.3.0:   '*'
  - more:	'slider'
  
provides:
  - mooTimePicker
...
*/
var mooTimePicker=new Class({Implements:[Options,Events],options:{secondsSliders:false,hoursSteps:"1",minuteSteps:"10",secsSteps:"30",hourLabel:"Hours",minsLabel:"Minutes",secsLabel:"Seconds",labelsPosition:"top",alwaysOn:false},initialize:function(g,l){this.setOptions(l);var z,a,j,I,e,H,L,o,J,p,u,f,v,x,G,r,n,K,t,y,D,k,d,b,q,E,F,C,A,w,B,M;x=new Element("div",{"class":"timePicker"});D=new Element("div",{"class":"sliders"});I=new Element("div",{"class":"labels"});z=new Element("div",{"class":"label",text:this.options.hourLabel});a=new Element("div",{"class":"label",text:this.options.minsLabel});j=new Element("div",{"class":"label",text:this.options.secsLabel});z.inject(I);a.inject(I);j.inject(I);e=new Element("div",{"class":"bar"});u=new Element("div",{"class":"back"});o=new Element("div",{"class":"knob",});H=new Element("div",{"class":"bar"});f=new Element("div",{"class":"back"});J=new Element("div",{"class":"knob",});u.inject(e);o.inject(e);f.inject(H);J.inject(H);e.inject(D);H.inject(D);if(this.options.secondsSliders){L=new Element("div",{"class":"bar"});v=new Element("div",{"class":"back"});p=new Element("div",{"class":"knob",});v.inject(L);p.inject(L);L.inject(D)}D.inject(x);I.inject(x,this.options.labelsPosition);x.inject(g.getParent());if(!this.options.alwaysOn){g.addEvent("focus",function(){var h=new Fx.Tween(D,{duration:500});h.start("opacity","1")});g.addEvent("blur",function(){var h=new Fx.Tween(D,{duration:500});h.start("opacity","0")})}n=$(g).getProperty("value");if(!n.contains(":")){if(this.options.secondsSliders){n="00:00:00"}else{n="00:00"}}else{if(this.options.secondsSliders){if(n.split(":").length<3){n=n+":00"}}}k=typeof(this.options.hoursSteps);d=new Array();switch(k){case"string":if(this.options.hoursSteps.contains(",")){d=this.options.hoursSteps.split(",");K=Object.getLength(d)}else{this.options.hoursSteps=this.options.hoursSteps.toInt();K=24/this.options.hoursSteps;E=0;F=0;while(E<K){d[E]=F;E++;F=F+this.options.hoursSteps}}break;case"object":Object.each(this.options.hoursSteps,function(s,m){d[m]=s});K=Object.getLength(d);break;case"array":K=this.options.hoursSteps.length();d=this.options.hoursSteps;break;case"number":default:K=24/this.options.hoursSteps;E=0;F=0;while(E<K){d[E]=F;E++;F=F+this.options.hoursSteps}break}if(typeof(d)=="object"){Object.keyOf(d,n.split(":")[0].toInt())?w=Object.keyOf(d,n.split(":")[0].toInt()):w=K}else{d.indexOf(n.split(":")[0].toInt())>-1?w=d.indexOf(n.split(":")[0].toInt()):w=K}k=typeof(this.options.minuteSteps);b=new Array();switch(k){case"string":if(this.options.minuteSteps.contains(",")){b=this.options.minuteSteps.split(",");t=Object.getLength(b)}else{this.options.minuteSteps=this.options.minuteSteps.toInt();t=60/this.options.minuteSteps;E=0;C=0;while(E<t){b[E]=C;E++;C=C+this.options.minuteSteps}}break;case"object":Object.each(this.options.minuteSteps,function(h,s){b[s]=h});t=Object.getLength(b);break;case"array":t=this.options.minuteSteps.length();b=this.options.minuteSteps;break;case"number":default:t=60/this.options.minuteSteps;E=0;C=0;while(E<t){b[E]=C;E++;C=C+this.options.minuteSteps}break}if(typeof(b)=="object"){Object.keyOf(b,n.split(":")[1].toInt())?B=Object.keyOf(b,n.split(":")[1].toInt()):B=t}else{b.indexOf(n.split(":")[1].toInt())>-1?B=b.indexOf(n.split(":")[1].toInt()):B=t}G=new Slider(e,o,{snap:true,steps:K-1,wheel:false,mode:"vertical",onChange:function(h){h=d[K-h-1];h<10?h="0"+h:h=h;var m,i;var s=g.getProperty("value");s=s.split(":");m=s[1];if(s.length>2){i=s[2];s=h+":"+m+":"+i}else{s=h+":"+m}g.setProperty("value",s);u.setStyle("height",e.getStyle("height").toInt()-o.getStyle("top").toInt()-o.getStyle("height").toInt())}}).set(w);r=new Slider(H,J,{snap:true,steps:t-1,wheel:false,mode:"vertical",onChange:function(i){i=b[t-i-1];i<10?i="0"+i:i=i;var h,m;var s=g.getProperty("value");s=s.split(":");h=s[0];if(s.length>2){m=s[2];s=h+":"+i+":"+m}else{s=h+":"+i}g.setProperty("value",s);f.setStyle("height",H.getStyle("height").toInt()-J.getStyle("top").toInt()-J.getStyle("height").toInt())}}).set(B);if(this.options.secondsSliders){k=typeof(this.options.secsSteps);q=new Array();switch(k){case"string":if(this.options.secsSteps.contains(",")){q=this.options.secsSteps.split(",");y=Object.getLength(q)}else{this.options.secsSteps=this.options.secsSteps.toInt();y=60/this.options.secsSteps;E=0;A=0;while(E<y){q[E]=A;E++;A=A+this.options.secsSteps}}break;case"object":Object.each(this.options.secsSteps,function(m,h){q[h]=m});y=Object.getLength(q);break;case"array":y=this.options.secsSteps.length();q=this.options.secsSteps;break;case"number":default:y=60/this.options.secsSteps;E=0;A=0;while(E<y){q[E]=A;E++;A=A+this.options.secsSteps}break}if(typeof(q)=="object"){Object.keyOf(q,n.split(":")[2].toInt())?M=Object.keyOf(q,n.split(":")[2].toInt()):M=y}else{q.indexOf(n.split(":")[2].toInt())>-1?M=q.indexOf(n.split(":")[2].toInt()):M=y}secs=new Slider(L,p,{snap:true,steps:y-1,wheel:false,mode:"vertical",onChange:function(m){m=q[y-m-1];m<10?m="0"+m:m=m;var h,i;var s=g.getProperty("value");s=s.split(":");h=s[0];i=s[1];s=h+":"+i+":"+m;g.setProperty("value",s);v.setStyle("height",L.getStyle("height").toInt()-p.getStyle("top").toInt()-p.getStyle("height").toInt())}}).set(M);v.setStyle("height",L.getStyle("height").toInt()-p.getStyle("top").toInt()-p.getStyle("height").toInt())}u.setStyle("height",e.getStyle("height").toInt()-o.getStyle("top").toInt()-o.getStyle("height").toInt());f.setStyle("height",H.getStyle("height").toInt()-J.getStyle("top").toInt()-J.getStyle("height").toInt());var c=new Fx.Tween(D,{duration:50});if(!this.options.alwaysOn){c.start("opacity","0")}},setOptions:function(a){Object.append(this.options,a)}});